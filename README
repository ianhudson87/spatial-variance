todo:
make sure sample applied to each image is the same for each epoch